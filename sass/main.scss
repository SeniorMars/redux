@import "fonts.scss";
@import "parts/_cards.scss";
@import "parts/_code.scss";
@import "parts/_header.scss";
@import "parts/_image.scss";
@import "parts/_toc.scss";
@import "parts/_misc.scss";
@import "parts/_table.scss";
@import "parts/_tags.scss";
@import "parts/_note.scss";
@import "parts/_mermaid.scss";
@import "parts/_spoiler.scss";
@import "parts/_search.scss";
@import "parts/_character.scss";

:root {
  /* Used for: block comment, hr, ... */
  --border-color: var(--bg-1);

  /* Fonts */
  --header-font: 'Space Grotesk', 'Helvetica', sans-serif;
  --text-font: 'Jetbrains Mono';
  --code-font: 'Jetbrains Mono';
  --paragraph-font: 'Source Serif 4';

  /* Layout */
  --page-width: 1000px;
  --line-height: 1.6;
}

html {
  background-color: var(--bg-0);
  color: var(--text-0);
  font-family: var(--text-font);
  line-height: var(--line-height);
}

/* Keep your OG font scaling behavior */
@media all and (max-width: 420px) {
  html { font-size: 15px; }
}

@media all and (max-width: 576px) {
  html { font-size: 16px; }
}

@media all and (min-width: 640px) {
  html { font-size: 16.5px; }
}

@media all and (min-width: 720px) {
  html { font-size: 17px; }
}

@media all and (min-width: 960px) {
  html { font-size: 18px; }
}

/* The key: body must be flex for the two-column layout to work */
body {
  display: flex;
  flex-grow: 1;
  min-height: calc(100vh - 150px);

  flex-direction: column;

  /* keep the padding style from the working version */
  padding: 0.9rem;
  padding-bottom: 1.5rem;
  margin-bottom: 1.5rem;

  /* Desktop: lay out content and toc side-by-side */
  @media (min-width: 992px) {
    flex-direction: row;
    justify-content: center;
    align-items: flex-start;
  }
}

.content {
  width: 100%;
  max-width: var(--page-width);
  margin: 0 auto;

  /* pick one padding system; this keeps the "24px" feel */
  padding: 0 24px;
  padding-bottom: 1.5rem;

  word-wrap: break-word;
  flex-shrink: 0;
}

time {
  font-family: var(--text-font);
}

p,
ol,
ul,
li,
table,
details {
  font-family: var(--paragraph-font);
}

/* Columns */
.left-content {
  width: 100%;

  @media (min-width: 992px) {
    flex: 1 1 0;
    min-width: 0;
  }
}

.right-content {
  width: 100%;

  @media (min-width: 992px) {
    flex: 1 1 0;
    min-width: 0;

    /* Sticky TOC behavior that you said works */
    position: sticky;
    top: 60px;

    padding: 1em;
    overflow-y: auto;
    max-height: calc(100vh - 100px);
  }
}

@media (max-width: 600px) {
  /* Use body as the single source of side padding */
  body {
    padding-left: calc(16px + env(safe-area-inset-left));
    padding-right: calc(16px + env(safe-area-inset-right));
  }

  /* Prevent double-padding from .content */
  .content {
    padding-left: 0;
    padding-right: 0;
  }
}

/* Older iOS fallback */
@supports (padding-left: constant(safe-area-inset-left)) {
  @media (max-width: 600px) {
    body {
      padding-left: calc(16px + constant(safe-area-inset-left));
      padding-right: calc(16px + constant(safe-area-inset-right));
    }
  }
}
